<%= TopicalMapBuilderIntegration::Util::MARGIN * margin_depth %>
<%  has_no_children = expanded.children.empty? 
    if has_no_children %>
      &#9674;
<%  else %>
<%=   link_to '-', contract_category_child_path(@main_category, expanded, :margin_depth => margin_depth), :remote => true, :loading => loading_kmaps_animation_script(expanded.id), :class => 'collapsable' %>
<%  end
    selected = (!@category.nil? && @category.id.to_i==expanded.id)
    if selected %>
      <span class="selectedCategory">
<%  end %>
<%= render :partial => 'selectable_category', :locals => { :category => expanded } %>
<%  if selected %>
      </span>
<%  end %>
<br/>
<%= render :partial => 'index', :locals => {:margin_depth => margin_depth+1, :categories => expanded.children} %>